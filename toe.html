<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tic Tac Toe</title>
  <style>
    :root{
      --bg: #0f1724;
      --card: #0b1220;
      --accent: #7c3aed;
      --muted: #94a3b8;
      --x-color: #ef4444;
      --o-color: #60a5fa;
      --glass: rgba(255,255,255,0.03);
    }
    [data-theme='light']{
      --bg: #f9fafb;
      --card: #ffffff;
      --accent: #6366f1;
      --muted: #6b7280;
      --x-color: #dc2626;
      --o-color: #2563eb;
      --glass: rgba(0,0,0,0.05);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: Inter, system-ui, sans-serif;
      background:var(--bg);
      color:#e6eef8;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }
    body[data-theme='light']{color:#111827}
    .cell {
  background:var(--glass);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:48px;
  font-weight:800;
  cursor:pointer;
  border-radius:8px;
  border: 2px solid red; /* ðŸ”´ red borders for each cell */
}
.card {
  width: 100%;
  max-width: 520px;
  background: var(--card);
  border-radius: 16px;
  padding: 20px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
  border: 3px solid red; /* default border (light theme or fallback) */
}

/* ðŸŒ™ Green border when in dark theme */
body[data-theme='dark'] .card {
  border-color: green;
}
.card{width:100%;max-width:520px;background:var(--card);border-radius:16px;padding:20px;box-shadow:0 10px 30px rgba(0,0,0,0.4);}
    .header{display:flex;flex-direction:column;align-items:center;justify-content:center;margin-bottom:14px;text-align:center;}
    .controls{display:flex;gap:8px;margin-top:10px;}
    button.btn{padding:8px 12px;border:none;border-radius:8px;cursor:pointer;font-weight:600;}
    .btn.primary{background:var(--accent);color:#fff;}
    .btn.secondary{background:var(--glass);color:inherit;}
    .board{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;aspect-ratio:1;border-radius:12px;margin-bottom:10px;}
    .cell{background:var(--glass);display:flex;align-items:center;justify-content:center;font-size:48px;font-weight:800;cursor:pointer;border-radius:8px;}
    .cell {
  background: var(--glass);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 48px;
  font-weight: 800;
  cursor: pointer;
  border-radius: 8px;
  border: 2px solid red; /* default */
}

/* ðŸŒ™ Green borders when in dark theme */
body[data-theme='dark'] .cell {
  border-color: green;
}
    .cell.x{color:var(--x-color)}
    .cell.o{color:var(--o-color)}
    .info{display:flex;flex-direction:column;align-items:center;gap:6px;font-weight:600;}
    select,option{padding:6px;border-radius:6px;border:1px solid var(--muted);background:var(--card);color:inherit;}
    .popup{
      position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.6);backdrop-filter:blur(4px);z-index:999;visibility:hidden;opacity:0;transition:opacity .3s ease,visibility .3s ease;
    }
    .popup.active{visibility:visible;opacity:1;}
    .popup-content{
      background:var(--card);padding:20px 30px;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.4);text-align:center;animation:pop .3s ease forwards;
    }
    @keyframes pop{from{transform:scale(0.8);opacity:0;}to{transform:scale(1);opacity:1;}}
  </style>
</head>
<body>
  <div class="card">
    <div class="header">
      <h2>Tic Tac Toe</h2>
      <small id="status">Turn: X</small>
      <div class="controls">
        <select id="modeSelect">
          <option value="2p">2 Players</option>
          <option value="easy">Easy</option>
          <option value="medium">Medium</option>
          <option value="hard">Hard</option>
        </select>
        <select id="themeSelect">
          <option value="dark">Dark</option>
          <option value="light">Light</option>
        </select>
        <button class="btn primary" id="resetBtn">Reset</button>
      </div>
    </div><div class="board" id="board"></div>

<div class="info">
  <div>Scores â€” X: <span id="scoreX">0</span> | O: <span id="scoreO">0</span> | Draws: <span id="scoreD">0</span></div>
  <button class="btn secondary" id="downloadBtn">Download Game</button>
</div>

  </div>  <div class="popup" id="popup">
    <div class="popup-content">
      <h3 id="popupText">Winner: X</h3>
      <button class="btn primary" id="closePopup">OK</button>
    </div>
  </div>  <script>
    const boardEl=document.getElementById('board');
    const statusEl=document.getElementById('status');
    const resetBtn=document.getElementById('resetBtn');
    const modeSelect=document.getElementById('modeSelect');
    const themeSelect=document.getElementById('themeSelect');
    const scoreXEl=document.getElementById('scoreX');
    const scoreOEl=document.getElementById('scoreO');
    const scoreDEl=document.getElementById('scoreD');
    const downloadBtn=document.getElementById('downloadBtn');
    const popup=document.getElementById('popup');
    const popupText=document.getElementById('popupText');
    const closePopup=document.getElementById('closePopup');

    let board=Array(9).fill('');
    let currentPlayer='X';
    let active=true;
    let scores=JSON.parse(localStorage.getItem('t3_scores'))||{X:0,O:0,D:0};
    let mode=localStorage.getItem('t3_mode')||'2p';
    let theme=localStorage.getItem('t3_theme')||'dark';

    modeSelect.value=mode;themeSelect.value=theme;document.body.dataset.theme=theme;

    function updateScoresUI(){
      scoreXEl.textContent=scores.X;scoreOEl.textContent=scores.O;scoreDEl.textContent=scores.D;
      localStorage.setItem('t3_scores',JSON.stringify(scores));
    }

    function renderBoard(){
      boardEl.innerHTML='';
      board.forEach((v,i)=>{
        const cell=document.createElement('div');
        cell.className='cell';
        cell.textContent=v;
        if(v) cell.classList.add(v.toLowerCase());
        cell.addEventListener('click',()=>makeMove(i));
        boardEl.appendChild(cell);
      });
    }

    function makeMove(i){
      if(!active||board[i])return;
      board[i]=currentPlayer;
      renderBoard();
      const winner=checkWinner();
      if(winner){endGame(winner);}else if(board.every(Boolean)){scores.D++;updateScoresUI();showPopup('Draw!');statusEl.textContent='Draw!';active=false;}
      else{
        currentPlayer=currentPlayer==='X'?'O':'X';
        statusEl.textContent='Turn: '+currentPlayer;
        if(isAIturn()) setTimeout(AIMove,400);
      }
    }

    function checkWinner(){
      const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
      for(const [a,b,c] of wins){if(board[a]&&board[a]===board[b]&&board[a]===board[c])return board[a];}
      return null;
    }

    function endGame(winner){
      statusEl.textContent='Winner: '+winner;
      scores[winner]++;updateScoresUI();active=false;
      showPopup('Winner: '+winner);
    }

    function showPopup(msg){
  popupText.textContent = msg;
  popup.classList.add('active');
  celebrate(); // ðŸŽŠ trigger confetti
}

    function celebrate(){
  const duration = 2000; // 10 seconds
  const end = Date.now() + duration;

  (function frame(){
    // Create a few confetti particles per frame
    const colors = ['#7c3aed', '#22c55e', '#eab308', '#ef4444', '#3b82f6'];
    const confetti = document.createElement('div');
    const size = Math.random() * 8 + 4;
    confetti.style.position = 'fixed';
    confetti.style.left = Math.random() * 100 + '%';
    confetti.style.top = '-10px';
    confetti.style.width = size + 'px';
    confetti.style.height = size + 'px';
    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
    confetti.style.borderRadius = '50%';
    confetti.style.opacity = 0.9;
    confetti.style.pointerEvents = 'none';
    confetti.style.zIndex = 1000;
    document.body.appendChild(confetti);

    // Animate the confetti falling
    const fallTime = Math.random() * 2000 + 1000;
    confetti.animate([
      { transform: `translateY(0) rotate(0deg)`, opacity: 1 },
      { transform: `translateY(100vh) rotate(${Math.random()*720}deg)`, opacity: 0.8 }
    ], {
      duration: fallTime,
      easing: 'ease-out',
      fill: 'forwards'
    });

    // Remove after animation
    setTimeout(() => confetti.remove(), fallTime);

    if (Date.now() < end) {
      requestAnimationFrame(frame);
    }
  })();

    }
    closePopup.addEventListener('click',()=>{
      popup.classList.remove('active');
      reset();
    });

    function isAIturn(){return mode!=='2p'&&currentPlayer==='O';}

    function AIMove(){
      if(!active)return;
      let move;
      const empty=board.map((v,i)=>v?null:i).filter(v=>v!==null);
      if(mode==='easy')move=empty[Math.floor(Math.random()*empty.length)];
      if(mode==='medium'){
        move=findWinningMove('O')||findWinningMove('X')||empty[Math.floor(Math.random()*empty.length)];
      }
      if(mode==='hard'){
        move=minimax(board,'O').index;
      }
      makeMove(move);
    }

    function findWinningMove(p){
      for(let i=0;i<9;i++){
        if(!board[i]){board[i]=p;if(checkWinner()===p){board[i]='';return i;}board[i]='';}
      }
      return null;
    }

    function minimax(newBoard,player){
      const avail=newBoard.map((v,i)=>v?null:i).filter(v=>v!==null);
      const winner=checkWinnerStatic(newBoard);
      if(winner==='X')return {score:-10};
      if(winner==='O')return {score:10};
      if(avail.length===0)return {score:0};
      const moves=[];
      for(let i of avail){
        const move={index:i};newBoard[i]=player;
        if(player==='O'){move.score=minimax(newBoard,'X').score;}
        else{move.score=minimax(newBoard,'O').score;}
        newBoard[i]='';moves.push(move);
      }
      let bestMove;
      if(player==='O'){let best=-Infinity;for(const m of moves){if(m.score>best){best=m.score;bestMove=m;}}}
      else{let best=Infinity;for(const m of moves){if(m.score<best){best=m.score;bestMove=m;}}}
      return bestMove;
    }

    function checkWinnerStatic(b){
      const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
      for(const [a,b,c] of wins){if(b[a]&&b[a]===b[b]&&b[a]===b[c])return b[a];}
      return null;
    }

    function reset(){
      board=Array(9).fill('');
      currentPlayer='X';
      active=true;
      statusEl.textContent='Turn: X';
      renderBoard();
      if(isAIturn()) setTimeout(AIMove,400);
    }

    resetBtn.addEventListener('click',reset);
    modeSelect.addEventListener('change',()=>{mode=modeSelect.value;localStorage.setItem('t3_mode',mode);reset();});
    themeSelect.addEventListener('change',()=>{theme=themeSelect.value;localStorage.setItem('t3_theme',theme);document.body.dataset.theme=theme;});

    downloadBtn.addEventListener('click',()=>{
      const blob=new Blob([document.documentElement.outerHTML],{type:'text/html'});
      const url=URL.createObjectURL(blob);
      const a=document.createElement('a');
      a.href=url;a.download='tic-tac-toe.html';a.click();URL.revokeObjectURL(url);
    });

    updateScoresUI();
    renderBoard();
  </script></body>
</html>